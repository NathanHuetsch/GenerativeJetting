# #########
# # General: #
# #########
runs_dir : "/remote/gpu05/palacios/GenerativeJetting/runs/OdeTolTest"
run_name : "3j"
redirect_console : True
# #########
# # Data: #
# #########
load_dataset : False
data_path : "/remote/gpu05/palacios/data/z+njet_full.h5"
preprocess : True
channels : [0,2,4,5,6,8,9,10,11,12,13,14,15,16, 17, 18, 19]
prior_path: "/remote/gpu05/palacios/GenerativeJetting/runs/z213/TBD_simple_full2552"
dim: 17
n_jets: 3
n_con: 0
con_depth: 0
#dim : 4
# ##############
# # Training:  #
# ##############
train: True
log: False
conditional: False
data_split: [0.6, 0.00, 0.4]

optimizer: Adam
lr : 1.e-3
batch_size : 16384
batch_size_sample : 100000
weight_decay : 0
betas : [0.9, 0.99]
use_scheduler: True
lr_scheduler: "CosineAnnealing"
#eta_min: 1.e-6
loss_type: "l2"
C: 0
multiple_t: False

n_epochs : 20000
validate: False
validate_every : 10

sample_periodically: True
sample_every: 7000
sample_every_n_samples: 100000
# #################
# # Architecture: #
# #################

encode_t: True
encode_t_dim: 64

model: TBD
network: "Resnet"
n_blocks : 1
layers_per_block : 8
intermediate_dim : 1024
n_head: 4
trajectory: "linear_trajectory"
# #################
# # Loading/saving: #
# ###################
warm_start : False
warm_start_path : "/remote/gpu05/palacios/GenerativeJetting/runs/z13/TBD_Visualize7322/models/model_run0.pt"

# #############
# # Sampling: #
# #############
sample: True
load_best_checkpoint: False
n_samples : 1000000

# #############
# # Plotting: #
# #############
plot : True
#plot_channels : [9, 10, 13, 14]
plot_deltaR: True
plot_Deta_Dphi: True