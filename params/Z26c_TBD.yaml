# #########
# # General: #
# #########
runs_dir : "/remote/gpu07/huetsch/GenerativeJetting/runs/MagicTrafoBayesian3Jets"
run_name : "512d8l_2pre_20k"
redirect_console : True

# #########
# # Data: #
# #########
bayesian: 2
data_path : "/remote/gpu07/huetsch/data/z+njet_full.h5"
data_type: np
preprocess : 2
n_jets: 3
load_dataset : False
#channels : [9, 10, 13, 14]
#[0, 4, 8, 9, 10, 12, 13, 14]
#dim : 4
# ##############
# # Training:  #
# ##############
train: True
log: True
data_split: [0.6, 0, 0.4]
conditional: False

optimizer: Adam
lr : 1.e-3
batch_size : 8192
weight_decay : 0
betas : [0.9, 0.99]
use_scheduler: True
lr_scheduler: "CosineAnnealing"
#eta_min: 1.e-6
loss_type: "l2"
C: 0.001
multiple_t: False

n_epochs : 20000
validate: False
validate_every : 100

sample_periodically: True
sample_every: 2000
sample_every_n_samples: 100000
# #################
# # Architecture: #
# #################
model: TBD
trajectory: "linear_trajectory"
beta_dist: False
beta_dist_b: 0.5
magic_transformation: True

encode_t: True
encode_t_dim: 64
#encode_t_scale: 10

network: "Resnet"
n_blocks : 1
intermediate_dim: 512
layers_per_block: 8
#normalization: "InstanceNorm1d"

resid_pdrop: 0
n_layers: 5
n_head: 4

#dropout: 0.2

# ###################
# # Loading/saving: #
# ###################
warm_start : False
warm_start_path : "/remote/gpu07/huetsch/GenerativeJetting/runs/Diff_4c_5internal_continue90419/model.pt"

# #############
# # Sampling: #
# #############
sample: True
load_best_checkpoint: False
n_samples : 1000000

# #############
# # Plotting: #
# #############
plot : True
#plot_channels : [9, 10, 13, 14]
#plot_deltaR: True
#plot_Deta_Dphi: True


